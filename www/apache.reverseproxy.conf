<VirtualHost *:80>
ServerAdmin     kiorky@localhost
DocumentRoot    /home/kiorky/projects/mc/testcgwb/www/htdocs/
ServerName      testcgwb.localhost
ErrorLog        /home/kiorky/projects/mc/testcgwb/var/log/apache/testcgwb.localhost_log
TransferLog     /home/kiorky/projects/mc/testcgwb/var/log/apache/testcgwb.localhost-access_log
CustomLog       /home/kiorky/projects/mc/testcgwb/var/log/apache/testcgwb.localhost-access_log combined
DirectoryIndex   index.html index.htm



<Directory "/home/kiorky/projects/mc/testcgwb/www/htdocs">
    Options  +ExecCGI +IncludesNOEXEC +FollowSymLinks -Indexes
    AllowOverride All
    <IfVersion < 2.4>
    Order allow,deny
    Allow from all
    </IfVersion>
    <IfVersion >= 2.4>
    Require all granted
    </IfVersion>
</Directory>
ProxyRequests off
<Proxy *>
  Order allow,deny
  Allow from all
</Proxy>
RewriteEngine  on
# maintainance page
RewriteCond /home/kiorky/projects/mc/testcgwb/www/htdocs/maintainance/index.html -f
RewriteCond %{REQUEST_URI} !^/(maintainance|zmiroot)
RewriteRule $ /maintainance/index.html [R=302,L]

# supervisor
ProxyPass         /supervisor/ http://127.0.0.1:8081/ retry=1
ProxyPassReverse  /supervisor/ http://127.0.0.1:8081/

# /zmiroot -> access to zmi
ProxyPass         /zmiroot/ http://127.0.0.1:8094/VirtualHostBase/http/testcgwb.localhost:80/VirtualHostRoot/_vh_zmiroot/ retry=1
ProxyPassReverse  /zmiroot/ http://127.0.0.1:8094/VirtualHostBase/http/testcgwb.localhost:80/VirtualHostRoot/_vh_zmiroot/

# /-> vhmonster proxyreverse because of redirects !
RewriteCond /home/kiorky/projects/mc/testcgwb/www/htdocs/maintainance/index.html !-f
RewriteRule ^(.*)$ http://127.0.0.1:8094/VirtualHostBase/http/testcgwb.localhost:80/Plone/VirtualHostRoot/$1 [P]
ProxyPassReverse  / http://127.0.0.1:8094/VirtualHostBase/http/testcgwb.localhost:80/Plone/VirtualHostRoot/

#RewriteLog "/home/kiorky/projects/mc/testcgwb/var/log/apache/rewrite.log"
#RewriteLogLevel 3

</VirtualHost>
<VirtualHost *:80>
ServerAdmin     kiorky@localhost
DocumentRoot    /home/kiorky/projects/mc/testcgwb/www/htdocs
ServerName      edit.localhost.com
ErrorLog        /home/kiorky/projects/mc/testcgwb/var/log/apache/edit.localhost.com_log
TransferLog     /home/kiorky/projects/mc/testcgwb/var/log/apache/edit.localhost.com-access_log
CustomLog       /home/kiorky/projects/mc/testcgwb/var/log/apache/edit.localhost.com-access_log combined
DirectoryIndex   index.html index.htm
<Directory "/home/kiorky/projects/mc/testcgwb">
    Options  +ExecCGI +IncludesNOEXEC +FollowSymLinks -Indexes
    <IfVersion < 2.4>
    Order allow,deny
    Allow from all
    </IfVersion>
    <IfVersion >= 2.4>
    Require all granted
    </IfVersion>
</Directory>
ProxyRequests off
<Proxy *>
  Order allow,deny
  Allow from all
</Proxy>
RewriteEngine  on

ProxyPass         /zmiroot/ http://127.0.0.1:8094/VirtualHostBase/http/edit.localhost.com:80/VirtualHostRoot/_vh_zmiroot/ retry=1
ProxyPassReverse  /zmiroot/ http://127.0.0.1:8094/VirtualHostBase/http/edit.localhost.com:80/VirtualHostRoot/_vh_zmiroot/

# maintenance page
RewriteCond /home/kiorky/projects/mc/testcgwb/www/htdocs/maintainance/index.html -f
RewriteCond %{REQUEST_URI} !^/(maintainance|zmiroot)
RewriteRule $ /maintainance/maintainance.html [R=302,L]

# supervisor
ProxyPass         /supervisor/ http://127.0.0.1:8081/
ProxyPassReverse  /supervisor/ http://127.0.0.1:8081/

# /-> vhmonster proxyreverse because of redirects !
RewriteCond /home/kiorky/projects/mc/testcgwb/www/htdocs/maintainance/index.html !-f
RewriteRule ^(.*)$   http://127.0.0.1:8094/VirtualHostBase/http/edit.localhost.com:80/Plone/VirtualHostRoot/$1 [P]
ProxyPassReverse  /  http://127.0.0.1:8094/VirtualHostBase/http/edit.localhost.com:80/Plone/VirtualHostRoot/

# vim: set ft=xml:
</VirtualHost>
